# Copyright 2019 Google LLC.
# SPDX-License-Identifier: Apache-2.0

# Author: Anton Mikhailov

turbo_colormap_data = [[0.18995000000000012, 0.07175999999999999, 0.23217],
 [0.19603285653372296, 0.08041863064584845, 0.2565564949784801],
 [0.2011018203807088, 0.08957613802242316, 0.2811690190054524],
 [0.20540758285836794, 0.09923050564314925, 0.30595297374320146],
 [0.20917716334435466, 0.10936498736871395, 0.3308537608540117],
 [0.21260748153915363, 0.1199476026461388, 0.35581678200016803],
 [0.21586027959281534, 0.13093078861500446, 0.38078743884395466],
 [0.21905833297964594, 0.1422512090808266, 0.40571113304765627],
 [0.22228286149038376, 0.15382972035558462, 0.43053326627355776],
 [0.22557202835013956, 0.1655714939654016, 0.4551992401839435],
 [0.2289203962620632, 0.17736629622537692, 0.479654456441098],
 [0.23227919412135992, 0.18908892468157007, 0.5038443167073059],
 [0.2355572372418838, 0.2005998014201369, 0.5277142226448518],
 [0.2386223371881553, 0.21174572324361776, 0.5512095759160203],
 [0.2413030347091822, 0.2223607687143777, 0.5742757781830958],
 [0.24339049082699077, 0.23226736206519802, 0.5968582311083632],
 [0.24464037684226653, 0.24127749397702064, 0.618902336354107],
 [0.24919409922384378, 0.25361358456573446, 0.6403534955826117],
 [0.25581466055849134, 0.2681436497135909, 0.6611575663272538],
 [0.2610486190410284, 0.28149828120694653, 0.6812856244543511],
 [0.2649945207221014, 0.29379848827417293, 0.7007466542467515],
 [0.267791346809535, 0.30519163330910454, 0.7195527668071229],
 [0.2696027655555311, 0.3158397597613307, 0.7377160732381338],
 [0.2706152430349715, 0.3259171758125416, 0.755248684642452],
 [0.2710362206122454, 0.3356083490911393, 0.772162712122746],
 [0.27109235909659896, 0.3451060385441109, 0.7884702667816837],
 [0.2710278495860071, 0.35460959610080095, 0.8041834597219337],
 [0.27109577181802413, 0.3643174604229092, 0.8193142666634508],
 [0.27141136226164686, 0.37430552592557637, 0.8338717878374745],
 [0.2719447644935107, 0.3845302489926426, 0.8478623744640685],
 [0.2726528054486133, 0.3949435331156365, 0.8612922676921365],
 [0.2734851649285665, 0.4054979355287546, 0.8741677086705817],
 [0.27438493059495384, 0.416147046302954, 0.886494938548308],
 [0.27528914125858783, 0.4268458508994891, 0.898280198474219],
 [0.2761293184646638, 0.43755109020175215, 0.909529729597218],
 [0.27683198637381107, 0.4482216305480463, 0.9202497730662091],
 [0.27732297154522656, 0.4588200031369176, 0.930443968271468],
 [0.27756550706573274, 0.4693232734525071, 0.9400880998501885],
 [0.2775470770705332, 0.47971634110939504, 0.94914105531816],
 [0.27725595081122206, 0.4899839326075581, 0.9575614851059157],
 [0.2766808823875009, 0.500110395348549, 0.9653080396439905],
 [0.2758111540642365, 0.5100795852792619, 0.9723393693629183],
 [0.27463662288080853, 0.5198747387076853, 0.9786141246932333],
 [0.2731477705527466, 0.5294783274632235, 0.9840909560654697],
 [0.2713357566656594, 0.5388718965001417, 0.9887285139101611],
 [0.269191894956033, 0.5480435057190336, 0.9924936332364398],
 [0.2667044148753134, 0.5570275193107788, 0.9954028924340418],
 [0.2638599926376072, 0.5658784081137819, 0.9974915600654356],
 [0.2606451182181313, 0.5746538472724767, 0.9987949382171235],
 [0.25704629364448894, 0.5834146350895782, 0.9993483289756077],
 [0.2530502075960165, 0.592224698511777, 0.9991870344273908],
 [0.24864388853698516, 0.6011511544864001, 0.998346356658975],
 [0.24381483638366383, 0.6102644266720901, 0.9968615977568626],
 [0.23855113313068285, 0.6196384157276741, 0.9947680593303486],
 [0.2328530429996469, 0.629324406529534, 0.9920881602937779],
 [0.22676326530337088, 0.6392785055179517, 0.9887978467044912],
 [0.22033498117692868, 0.6494280858030523, 0.9848625889597477],
 [0.2136223204759567, 0.6596916548467479, 0.9802478574568076],
 [0.2066801091820565, 0.669978334841504, 0.9749191225929306],
 [0.19956358295892954, 0.6801875199013803, 0.9688418547653761],
 [0.1923280668592458, 0.6902087205781637, 0.9619815243714038],
 [0.1850286211822454, 0.6999216051944804, 0.9543036018082742],
 [0.17771966565947578, 0.709196690368163, 0.9457739949101917],
 [0.17045654138199418, 0.7179834871678766, 0.9364436909721032],
 [0.1632953125073928, 0.7264264624436629, 0.9265498715147663],
 [0.1562864405123611, 0.7347108756001549, 0.9163543583150338],
 [0.14947424799517858, 0.7430393047123492, 0.9061189731497593],
 [0.14289717429744675, 0.7516328009962486, 0.8961055377957958],
 [0.1365880251442317, 0.7607321514933496, 0.8865758740299964],
 [0.13057421630261867, 0.7705992552944236, 0.8777918036292144],
 [0.12487801125867679, 0.7815186182843411, 0.8700151483703031],
 [0.11951700574728699, 0.7937949057925863, 0.863504808110266],
 [0.11451576722312658, 0.8075756961835326, 0.8583908723611844],
 [0.10991313060444288, 0.8227655513768399, 0.8546267214403315],
 [0.10575033405806372, 0.8392420431563783, 0.852152932782515],
 [0.10207089904641702, 0.8509100838225422, 0.8449488274831121],
 [0.09892147623082612, 0.85083875199522, 0.8261709502491228],
 [0.09635259327974559, 0.851879514735356, 0.8087726706620073],
 [0.09441930458194023, 0.8539729494777577, 0.7928119644739255],
 [0.09318174286460465, 0.8570596336572316, 0.7783629919496681],
 [0.0927036181048223, 0.8610775924928397, 0.7655041233985559],
 [0.09301866222602442, 0.8659182801203674, 0.7541056188137077],
 [0.09413424808159886, 0.8714324622751551, 0.7438529886496308],
 [0.09606024400570655, 0.8774695357428354, 0.7344329883101471],
 [0.09880886388831697, 0.883878897309042, 0.725539728420338],
 [0.10239343290578767, 0.8905099437594082, 0.7168749469608289],
 [0.10682711456462665, 0.897212071879568, 0.7081490046095532],
 [0.11212159905844298, 0.9038346784551543, 0.6990826064311108],
 [0.11828575293807674, 0.9102271602718007, 0.6894092336000802],
 [0.1253213005636364, 0.916250415678003, 0.678905814420826],
 [0.13319733606806392, 0.9218745786839673, 0.6676257657944034],
 [0.14186439243101565, 0.9271301475654119, 0.6557694798164176],
 [0.15127062102601385, 0.9320482564689314, 0.6435354485169366],
 [0.1613624303393316, 0.9366600395411213, 0.6311164145936581],
 [0.1720849196676174, 0.9409966309285761, 0.6186973257325131],
 [0.18338227246106584, 0.9450891647778904, 0.6064535578789391],
 [0.19519810931213866, 0.94896877523566, 0.5945494105720865],
 [0.20747580058983464, 0.9526665964484793, 0.5831368740112969],
 [0.22015028897305264, 0.9562107024991099, 0.5723050546258497],
 [0.23310995416036553, 0.9596124410597247, 0.5618616485143343],
 [0.24622596300039312, 0.9628774735436901, 0.5515199589855212],
 [0.25936790360443934, 0.9660114566635455, 0.5409929426394762],
 [0.2724039776969065, 0.9690200471318308, 0.5299929410655195],
 [0.28520116512651067, 0.9719089016610856, 0.5182303612595305],
 [0.29762537341602513, 0.9746836769638495, 0.5054113662245532],
 [0.3095415723505516, 0.9773500297526625, 0.4912345630240125],
 [0.32081390917258457, 0.9799136156851815, 0.47538670949499023],
 [0.33128925520432406, 0.9823761663867385, 0.4576534499005831],
 [0.34075941889494876, 0.9847266383239686, 0.43816003873419157],
 [0.34900354148258544, 0.9869513925561251, 0.4170440972513165],
 [0.3557993494492655, 0.989036790142461, 0.39437781175819453],
 [0.3609236141031325, 0.9909691921422308, 0.37017260500943305],
 [0.3839187403807655, 0.9927349596146877, 0.3641526680417138],
 [0.4135910689786268, 0.9943204536190855, 0.36526297849625317],
 [0.44036084032648265, 0.9957120352146777, 0.3640317775571059],
 [0.46391650398713574, 0.9968960828382578, 0.36023932497041167],
 [0.48426191211298214, 0.9978612691671377, 0.3538762945791576],
 [0.5019779235053956, 0.9986008295720095, 0.3453512286083146],
 [0.5176319166678188, 0.9991085388872384, 0.33512610246528823],
 [0.5317114367754172, 0.999378171947191, 0.32366652037442906],
 [0.5446344968333751, 0.9994035035862331, 0.3114407130504342],
 [0.5567589628170662, 0.9991783086387308, 0.2989184777120854],
 [0.5683909823495459, 0.9986963619390499, 0.28657006043632566],
 [0.5797924208411835, 0.9979514383215564, 0.27486498085267125],
 [0.5911838021055043, 0.9969375724082512, 0.26426394691370436],
 [0.6026353565670068, 0.9956581212582893, 0.25497878811500485],
 [0.6140718889330244, 0.9941281209485175, 0.2469107099317435],
 [0.6254337875904203, 0.9923633461765268, 0.23993969420396533],
 [0.6366842665103487, 0.9903795716399088, 0.23394448593346095],
 [0.6478065267547535, 0.988192572036254, 0.22880304619311317],
 [0.658801239134924, 0.9858181220631538, 0.22439296566510594],
 [0.669684363646041, 0.9832719964181996, 0.22059183880799763],
 [0.6804853172418891, 0.9805699697989818, 0.21727759865265633],
 [0.6912432240782737, 0.9777249209904268, 0.21433319270353632],
 [0.7019694993151627, 0.9747039388162375, 0.21171153615332935],
 [0.7126447621527351, 0.9714375615915748, 0.2094209267765026],
 [0.7232427723057436, 0.9678553090814107, 0.20747079924191722],
 [0.7337306704393366, 0.9638867010507164, 0.20586982358876046],
 [0.7440683906380193, 0.9594612572644631, 0.2046255076645949],
 [0.7542080058978758, 0.9545084974876221, 0.20374376010572093],
 [0.7640930164549256, 0.9489579414851652, 0.20322841385984913],
 [0.7736575926590551, 0.9427391090220636, 0.2030807102510865],
 [0.7828382103259465, 0.9358085531848868, 0.20329440505371305],
 [0.7916748828411162, 0.9283514703650407, 0.20382465343739917],
 [0.8002846489905615, 0.9206680247352302, 0.20461155549260923],
 [0.8088170267358641, 0.9130592512823332, 0.20560119606133906],
 [0.8174544426723713, 0.9058261849932272, 0.2067468138078898],
 [0.8264122020989757, 0.8992698608547902, 0.2080090921566386],
 [0.83593774957197, 0.8936913138539, 0.2093557158857688],
 [0.8463093495862064, 0.8893915789774345, 0.21076019337696275],
 [0.8578343147063109, 0.886671691212271, 0.21219994452105553],
 [0.870787749396517, 0.8857621552475959, 0.2136566320895517],
 [0.8851649369559617, 0.8865463103322884, 0.21512382378249523],
 [0.8888008599824121, 0.876745885741306, 0.2165940870518319],
 [0.8923024790475472, 0.8668738252911876, 0.21805558610765105],
 [0.8968278423772751, 0.8580122852288239, 0.2194935516663317],
 [0.9021536248211766, 0.8498793160176384, 0.22089154738158148],
 [0.9080565012288319, 0.8422096029652834, 0.22223253168618234],
 [0.9143131464498222, 0.834754024968556, 0.22349971504443694],
 [0.9207002694797652, 0.8272794153952239, 0.22467720894732474],
 [0.9270358833724454, 0.8196177591176281, 0.2257459198298949],
 [0.9332594991048592, 0.8117566678771664, 0.22667410938837165],
 [0.9393328554594639, 0.8037130058930234, 0.22742725771174668],
 [0.9452176912187161, 0.7955054655439205, 0.2279704684627531],
 [0.9508757451650733, 0.7871545632470339, 0.22826856898185652],
 [0.9562687560809924, 0.7786826474259454, 0.22828622939736729],
 [0.96135846274893, 0.7701139206583935, 0.22798810074167128],
 [0.9661066039513434, 0.7614744773465534, 0.2273389720735789],
 [0.9704751112665982, 0.7527921492488312, 0.22630414607149843],
 [0.9744442187049852, 0.7440767492481226, 0.22486838621367886],
 [0.9780272805052139, 0.7353023899988497, 0.22305149178140496],
 [0.9812411381773049, 0.7264383724552371, 0.22087765325800743],
 [0.9841026332312791, 0.7174528767058942, 0.21837172617327372],
 [0.9866286071771574, 0.7083129364490678, 0.21555911462718963],
 [0.9888359015249599, 0.6989844158901782, 0.21246566177446186],
 [0.9907413577847078, 0.6894319921078632, 0.2091175472698132],
 [0.9923618174664217, 0.679619145382508, 0.20554119167405643],
 [0.9937139089234208, 0.6695091431139281, 0.20176294251811103],
 [0.9948079249912337, 0.6590935676262998, 0.19780254482471646],
 [0.9956469070056158, 0.6483977827184007, 0.19367221827326164],
 [0.9962334989013887, 0.637449864756797, 0.18938391978905814],
 [0.9965703446133757, 0.6262787548997503, 0.18494974043564968],
 [0.9966600880763996, 0.6149142247838949, 0.1803818815477465],
 [0.9965053732252823, 0.6033868365212083, 0.17569263131177404],
 [0.9961088439948473, 0.5917278970303983, 0.17089434179403462],
 [0.9954731443199172, 0.5799694067528419, 0.16599940641648434],
 [0.9946007524903391, 0.56814273488406, 0.1610200942409222],
 [0.993491860514712, 0.5562622435466189, 0.15596670620753875],
 [0.9921449938404994, 0.5443297038257391, 0.15084815188314699],
 [0.9905586401110726, 0.5323466559007257, 0.14567336788372245],
 [0.9887312869698036, 0.5203146938699471, 0.1404513382565646],
 [0.9866614220600641, 0.5082354638454596, 0.1351910817065928],
 [0.9843475330252258, 0.4961106636544126, 0.1299016386557453],
 [0.9817881075086604, 0.48394204419639425, 0.1245920581354842],
 [0.97898163315374, 0.47173141249780337, 0.11927138451240074],
 [0.9759289210539788, 0.4594854707797127, 0.11395054573192663],
 [0.9726483394662115, 0.4472474285013833, 0.10865460868250446],
 [0.9691662792053353, 0.4350768848119341, 0.10341443745671972],
 [0.9655091723343142, 0.42303303855625946, 0.09825999851522392],
 [0.9617034509161131, 0.41117446591749085, 0.09322029382763307],
 [0.9577755470136952, 0.399558992202729, 0.08832334161243074],
 [0.9537518926900252, 0.3882435736273872, 0.08359617061560219],
 [0.9496589200080665, 0.37728419082660136, 0.079064827928006],
 [0.945523061030784, 0.36673575572652917, 0.07475440034147354],
 [0.9413621790900766, 0.3566353547896003, 0.0706825874703025],
 [0.9371561243129084, 0.3469453550597822, 0.06683803397021328],
 [0.9328742092231169, 0.33760778416018716, 0.06320196869007207],
 [0.9284857459542007, 0.3285650553631604, 0.05975624727606544],
 [0.923960046639658, 0.3197600633877885, 0.056483309230300795],
 [0.9192664234129871, 0.3111362945818949, 0.05336614424145977],
 [0.9143741884076868, 0.3026379537261475, 0.05038826808457505],
 [0.9092526537572552, 0.294210108814785, 0.04753370808994092],
 [0.9038711509029115, 0.28579888817106097, 0.04478700463225811],
 [0.8982097756422616, 0.2773699565790842, 0.04213675791596255],
 [0.8922772728113265, 0.2689383168865316, 0.03958122035108788],
 [0.8860871010453079, 0.2605265065507877, 0.037119999549705476],
 [0.8796527189794067, 0.2521564172275788, 0.034752478462146144],
 [0.8729875852488239, 0.243849246533981, 0.0324778308719617],
 [0.8661051584887612, 0.23562545415778166, 0.030295036435396838],
 [0.8590188973344192, 0.2275047223995633, 0.028202895265368188],
 [0.8517422604209992, 0.2195059212217161, 0.026200042059950968],
 [0.8442886291783754, 0.21164696696986307, 0.024284968903589062],
 [0.8366658825947357, 0.20393709620616385, 0.0224566833954461],
 [0.8288728289325027, 0.19637227719541422, 0.02071516078182236],
 [0.8209074292077074, 0.18894736118934413, 0.01906038419978012],
 [0.8127676444363813, 0.1816573317241776, 0.01749224184541521],
 [0.8044514356345555, 0.174497324002044, 0.016010523681457035],
 [0.7959567638182617, 0.16746264456060034, 0.014614918103842994],
 [0.7872815900035307, 0.16054879119754545, 0.013305008567266375],
 [0.7784238752063946, 0.15375147311490078, 0.012080270169695012],
 [0.7693815094296155, 0.14706665061924598, 0.010940106125373182],
 [0.7601506091299226, 0.14049102794132184, 0.009884789843752777],
 [0.750725435620039, 0.1340221286645456, 0.008915453586460181],
 [0.7411001628694729, 0.1276578429345052, 0.00803306084121432],
 [0.7312689648477328, 0.12139641741248426, 0.007238343932194122],
 [0.7212260155243265, 0.11523646909122104, 0.006531790772371057],
 [0.7109654888687623, 0.10917699938693418, 0.005913631167964653],
 [0.7004815588505486, 0.10321740838864098, 0.005383822675031824],
 [0.6897683994391935, 0.0973575091373872, 0.00494203600818285],
 [0.6788216414826612, 0.09159799797392862, 0.004587680829071061],
 [0.6676545784889113, 0.085945331943603, 0.004320329426210998],
 [0.6562922539381035, 0.08040919620310295, 0.004139497553330971],
 [0.6447599237143126, 0.0749986651380395, 0.004044322329843426],
 [0.6330828437016137, 0.0697221221537304, 0.004033579228908767],
 [0.6212862697840816, 0.06458724902015898, 0.00410570761047724],
 [0.6093954578457914, 0.05960101650879957, 0.004258838687695317],
 [0.5974356637708177, 0.05476967646555888, 0.004490825926684591],
 [0.585432143443236, 0.050098755475732434, 0.004799277879685378],
 [0.5734101527471211, 0.045593050289068016, 0.005181593451571591],
 [0.5613949475665478, 0.04125662518570513, 0.005634999599733775],
 [0.5494117837855912, 0.03709281147695922, 0.006156591467329084],
 [0.5374859172883263, 0.033104209348629815, 0.006743374949901307],
 [0.5256426039588279, 0.02929269226872688, 0.0073923116953697465],
 [0.5139070996811711, 0.025659414196234253, 0.008100366537384785],
 [0.502304660339431, 0.02220481984277347, 0.008864557362053972],
 [0.49086054181768224, 0.018928658254771653, 0.009682007408035407],
 [0.4796, 0.01583, 0.010550000000000002]]
# The look-up table contains 256 entries. Each entry is a floating point sRGB triplet.
# To use it with matplotlib, pass cmap=ListedColormap(turbo_colormap_data) as an arg to imshow() (don't forget "from matplotlib.colors import ListedColormap").
# If you have a typical 8-bit greyscale image, you can use the 8-bit value to index into this LUT directly.
# The floating point color values can be converted to 8-bit sRGB via multiplying by 255 and casting/flooring to an integer. Saturation should not be required for IEEE-754 compliant arithmetic.
# If you have a floating point value in the range [0,1], you can use interpolate() to linearly interpolate between the entries.
# If you have 16-bit or 32-bit integer values, convert them to floating point values on the [0,1] range and then use interpolate(). Doing the interpolation in floating point will reduce banding.
# If some of your values may lie outside the [0,1] range, use interpolate_or_clip() to highlight them.

def interpolate(colormap, x):
  x = max(0.0, min(1.0, x))
  a = int(x*255.0)
  b = min(255, a + 1)
  f = x*255.0 - a
  return [colormap[a][0] + (colormap[b][0] - colormap[a][0]) * f,
          colormap[a][1] + (colormap[b][1] - colormap[a][1]) * f,
          colormap[a][2] + (colormap[b][2] - colormap[a][2]) * f]

def interpolate_or_clip(colormap, x):
  if   x < 0.0: return [0.0, 0.0, 0.0]
  elif x > 1.0: return [1.0, 1.0, 1.0]
  else: return interpolate(colormap, x)